// @ts-nocheck
export const ItemProperties={weaponProperties:{finesse:{name:"Finesse",description:"Can use STR or DEX for attacks and damage",type:"weapon"},reach:{name:"Reach",description:"Threat range increased by 5 feet",type:"weapon"},thrown:{name:"Thrown",description:"Can be thrown with range 10/20",type:"weapon"},light:{name:"Light Weapon",description:"Can be used in off-hand, added to TWF attacks",type:"weapon"},twohanded:{name:"Two-Handed",description:"Requires two hands to wield effectively",type:"weapon"},versatile:{name:"Versatile",description:"Can be wielded with one or two hands",type:"weapon"},ammunition:{name:"Ammunition",description:"Requires ammunition to fire",type:"weapon"},disarm:{name:"Disarm",description:"Can be used for disarm attempts without penalty",type:"weapon"},dangerous:{name:"Dangerous",description:"Deals 1d6 extra damage on a successful hit",type:"weapon"},parry:{name:"Parry",description:"Can be used to parry attacks",type:"weapon"},sunder:{name:"Sunder",description:"Effective for sundering other items",type:"weapon"},trip:{name:"Trip",description:"Can be used for trip attempts",type:"weapon"}},armorTypes:{light:{name:"Light Armor",description:"Doesn't impede movement or impose skill penalties",type:"armor",category:"light"},medium:{name:"Medium Armor",description:"Allows some movement, small skill penalties",type:"armor",category:"medium"},heavy:{name:"Heavy Armor",description:"Severely limits movement and imposes skill penalties",type:"armor",category:"heavy"},shield:{name:"Shield",description:"Provides AC bonus, can be used with armor",type:"armor",category:"shield"}},rarities:{common:{name:"Common",description:"Everyday items, no special properties",color:"#808080"},uncommon:{name:"Uncommon",description:"Difficult to find, has minor magic",color:"#1eff00"},rare:{name:"Rare",description:"Very difficult to find, significant magic",color:"#0070dd"},veryrare:{name:"Very Rare",description:"Extremely difficult to find, powerful magic",color:"#a335ee"},legendary:{name:"Legendary",description:"Unique or nearly unique, extremely powerful",color:"#ff8000"},artifact:{name:"Artifact",description:"One-of-a-kind item with immense power",color:"#e6cc80"}},qualities:{masterwork:{name:"Masterwork",description:"+1 bonus to attack rolls",type:"quality"},enchanted:{name:"Enchanted",description:"Magical item with special properties",type:"quality"},cursed:{name:"Cursed",description:"Item has a curse attached",type:"quality"},intelligent:{name:"Intelligent",description:"Item has sentience and abilities",type:"quality"},sentient:{name:"Sentient",description:"Item is fully sentient with personality",type:"quality"}}};export class ItemPropertyManager{constructor(e){this.item=e,this.initializeProperties()}initializeProperties(){this.item.system.properties||(this.item.system.properties={}),"weapon"===this.item.type?this.initializeWeaponProperties():"armor"===this.item.type&&this.initializeArmorProperties(),this.item.system.properties.rarity=this.item.system.properties.rarity||"common",this.item.system.properties.identified=!1!==this.item.system.properties.identified,this.item.system.properties.masterwork=this.item.system.properties.masterwork||!1,this.item.system.properties.weight=this.item.system.properties.weight||0,this.item.system.properties.cost=this.item.system.properties.cost||0}initializeWeaponProperties(){this.item.system.properties.finesse=this.item.system.properties.finesse||!1,this.item.system.properties.reach=this.item.system.properties.reach||!1,this.item.system.properties.thrown=this.item.system.properties.thrown||!1,this.item.system.properties.light=this.item.system.properties.light||!1,this.item.system.properties.twohanded=this.item.system.properties.twohanded||!1,this.item.system.properties.versatile=this.item.system.properties.versatile||!1,this.item.system.properties.ammunition=this.item.system.properties.ammunition||!1}initializeArmorProperties(){this.item.system.properties.armorType=this.item.system.properties.armorType||"light",this.item.system.properties.acBonus=this.item.system.properties.acBonus||0,this.item.system.properties.checkPenalty=this.item.system.properties.checkPenalty||0,this.item.system.properties.spellFailureChance=this.item.system.properties.spellFailureChance||0}hasProperty(e){return!0===this.item.system.properties[e]}setProperty(e,t){this.item.system.properties[e]=t}getWeaponProperties(){if("weapon"!==this.item.type)return[];const e=this.item.system.properties||{};return Object.keys(ItemProperties.weaponProperties).filter(t=>!0===e[t]).map(e=>ItemProperties.weaponProperties[e])}getPropertyAttackBonus(){let e=0;return this.item.system.properties?.masterwork&&(e+=1),this.item.system.properties?.enhancement&&(e+=this.item.system.properties.enhancement),e}calculateItemValue(){const e=this.item.system.properties?.cost||0;let t=1;return this.item.system.properties?.masterwork&&(t*=1.3),this.item.system.properties?.enhancement&&(t*=2**this.item.system.properties.enhancement),e*t}setIdentified(e=!0){this.item.system.properties.identified=e}isIdentified(){return!1!==this.item.system.properties?.identified}getDisplayName(){const e=ItemProperties.rarities[this.item.system.properties?.rarity||"common"],t=e?.color||"#ffffff";let i=this.item.name;return this.isIdentified()||(i=`${i} (Unidentified)`),`<span style="color: ${t};">${i}</span>`}getFullDescription(){let e=this.item.system.description?.value||"";const t=[];this.item.system.properties?.masterwork&&t.push("Masterwork (+1 to attacks)"),this.item.system.properties?.enhancement&&t.push(`+${this.item.system.properties.enhancement} Enhancement`);const i=ItemProperties.rarities[this.item.system.properties?.rarity];return i&&t.push(`Rarity: ${i.name}`),t.length>0&&(e+=`\n\n**Properties:** ${t.join(", ")}`),e}}